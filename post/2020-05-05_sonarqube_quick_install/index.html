<!doctype html><html lang=zh-tw><head><meta charset=utf-8><title>安裝 SonarQube - 為你的團隊建立軟體品質儀表板 - Kodofish Blog</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.82.0"><meta property="og:site_name" content="Kodofish Blog"><meta property="og:title" content="安裝 SonarQube - 為你的團隊建立軟體品質儀表板"><meta property="og:description" content="一個寫了十多年 ASP.Net 的資深工程師，曾任職PM、經理 等管理職務，但最愛還是動手寫程式。除了不斷學習各種新技術外，Agile、Scrum、DevOps…等實務也是不斷探索與學習的課題。"><meta property="description" content="一個寫了十多年 ASP.Net 的資深工程師，曾任職PM、經理 等管理職務，但最愛還是動手寫程式。除了不斷學習各種新技術外，Agile、Scrum、DevOps…等實務也是不斷探索與學習的課題。"><meta property="og:url" content="https://kodofish.dev/post/2020-05-05_sonarqube_quick_install/"><meta property="og:type" content="article"><meta property="og:image" content="https://kodofish.dev/img/fotis-fotopoulos-LJ9KY8pIH3E-unsplash.jpg"><meta property="og:image:alt" content><link rel=stylesheet href=/css/bundle.min.dfd552990dc3fbf73c5199086d302d4d102b5246a749a72560d6a20864d060c0.css integrity="sha256-39VSmQ3D+/c8UZkIbTAtTRArUkanSaclYNaiCGTQYMA="><link rel=stylesheet href=/css/add-on.css></head><body><header id=site-header><nav id=site-nav><h1 class=nav-title><a href=/ class=nav>安裝 SonarQube - 為你的團隊建立軟體品質儀表板</a></h1><menu id=site-nav-menu class="flyout-menu menu"><a href=/ class="nav link"><i class="fa fa-home"></i> Home</a>
<a href=/about/ class="nav link"><i class="far fa-id-card"></i> About</a>
<a href=/categories/ class="nav link"><i class="fas fa-sitemap"></i> Categories</a></menu>
<a href=#lang-menu class="nav lang-toggle" lang=zh-tw>zh-tw</a>
<a href=#site-nav class="nav nav-toggle"><i class="fas fa-bars fa-2x"></i></a></nav><menu id=lang-menu class="flyout-menu menu"><a href=# lang=zh-tw class="nav link active">中文 (zh-tw)</a></menu></header><div id=wrapper><section id=site-intro><a href=/><img src=https://kodofish.dev/img/main/52803026_10216197131793970_7809465358447804416_o.jpg class=circle width=200 alt=kodofish.dev></a><header><h1>軟體工程實踐練習場</h1></header><main><p>有想到什麼就會拿來寫寫看</p></main><footer><ul class=socnet-icons><li><a href=//github.com/kodofish target=_blank rel=noopener title=GitHub class="fab fa-github"></a></li><li><a href=//www.linkedin.com/in/kodofishchang target=_blank rel=noopener title=LinkedIn class="fab fa-linkedin"></a></li><li><a href=//facebook.com/kodofish target=_blank rel=noopener title=Facebook class="fab fa-facebook"></a></li><li><a href=//instagram.com/kodofish target=_blank rel=noopener title=Instagram class="fab fa-instagram"></a></li><li><a href=//twitter.com/kodofish target=_blank rel=noopener title=Twitter class="fab fa-twitter"></a></li></ul></footer></section><main id=site-main><article class=post><header><div class=title><h2><a href=/post/2020-05-05_sonarqube_quick_install/>安裝 SonarQube - 為你的團隊建立軟體品質儀表板</a></h2></div><div class=meta><time datetime="2020-05-05 13:24:55 +0800 +0800">May 5, 2020</time></div></header><div id=socnet-share></div><div class=content><a href=/post/2020-05-05_sonarqube_quick_install/ class=image style="--bg-image:url('https://kodofish.dev/img/fotis-fotopoulos-LJ9KY8pIH3E-unsplash.jpg')"><img src=https://kodofish.dev/img/fotis-fotopoulos-LJ9KY8pIH3E-unsplash.jpg alt></a><p>從事軟體開發工作已經多年，軟體品質、工程師績效向來是一直難以量化呈現的問題。過去曾看過管理階層試圖以各種方式來定義，但總有許多技術上的問題與人性挑戰。無法量化，團隊就難以對於品質有一致的認知，沒有一致的認知在開發的過程中多少就會有些許的衝突。</p><p>而 SonarQube 就是個讓你可以把團隊的軟體品質給數據化呈現出來軟體，也能讓團隊瞭解所開發的軟體是否有些潛在的問題。</p><blockquote><p>如果你無法加以量度，或是無法以數字將之表達出來，那麼你對於那樣東西的所知，則要歸於貧乏之列，或是嚴重不足— Lord Kelvin</p></blockquote><p>這篇來講講 SonarQube 安裝，這篇是我在安裝 SonarQube 時的安裝過程整理，</p><h2 id=下載-sonarqube>下載 SonarQube</h2><p>在 <a href=https://www.sonarqube.org/downloads/>SonarQube 官網</a> 提供了幾個版本可以下載，分為 Community、Developer、Enterprise 與 Data Center 四個版本，可依自己的需求下載適合的版本。由於這次是先試用評估功能，所以就先下載 Community 的版本。</p><p><img src=images/SonarQube_download.PNG alt="SonarQube download"></p><h2 id=快速啟動-sonarqube>快速啟動 SonarQube</h2><p>這方式蠻適合想先試用 SonarQube 評估對於團隊的幫助有多少時，可以先用快速安裝來減少前期準備的時間。
將先前下載的 SonarQube 解壓縮並放在適合的位置後，以命令列執行 StarSonar.bat。例如：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-batch data-lang=batch>$SONARQUBE-HOME\bin\windows-x86-xx\StartSonar.bat
</code></pre></div><p>就官方文件上寫的，這樣應該就可以啟動 SonarQube 了，但我執行就看到這樣的訊息。</p><p><img src=images/SonarQube_execute_fail.PNG alt="SonarQube execute fail"></p><p>在訊息的一開始有個 <code>Unable to execute Java command.</code> 的訊息，猜想可能是找不到 java 執行檔, 試著用 command line 去執行 java。</p><p><img src=images/execute_java.PNG alt="execute java"></p><p>果然!! 找不到 Java，找不到 java 就將 java 加入環境參數內，再重新執行一次。這次就順利執行起來了, 打開瀏覽器輸入 <code>http://localhost:9000/</code> 看到 SonarQube 的畫面就完成了。</p><ul><li><a href=https://docs.sonarqube.org/latest/setup/get-started-2-minutes/>SonarQube - Get Started in Two Minutes Guide</a></li></ul><h2 id=完整安裝-sonarqube>完整安裝 SonarQube</h2><p>前一節的快速啟動算是可以讓你用較短的時間將 SonarQube 執行起來，並開始試用它。但只要伺服器重新開機就必須手動再重新執行一次，對於長期使用來說並不方便，而且前面也提到過沒有安裝資料庫，未來若是程式升級或是你想要搬伺服器的話，資料有可能是無法轉移的。因此這一節來說說該如何完整安裝 SonarQube。</p><p>在執行 SonarQube 前，有兩件事要先準備好。第一是安裝 Java JRE 11。第二是安裝資料庫。</p><h3 id=安裝-java-jre-11>安裝 Java JRE 11</h3><p>在這一步，我本來是想照著文件安裝 Java JRE 11 就好了，但找來找去找不到, 索興安裝 Java JDK 11。</p><ul><li><a href=https://www.oracle.com/java/technologies/javase-jdk11-downloads.html>Java JRE 官方下載</a></li></ul><h3 id=安裝資料庫>安裝資料庫</h3><p>這個步驟是可以略過的，SonarQube 就會將資料儲存在本地，但這方法官方有說是不支援未來的升級與轉移的，所以已經確定要正式導入團隊使用時，建議還是採用完整安裝，建立專用的資料庫來讓 SonarQube 使用會比較恰當。</p><p>資料庫支援 PostgreSQL、MS SQL、Oracle 這種資料庫，就挑選自己熟悉或喜歡的裝，若是用在公司還是要考量公司的技術偏好與可支援的程度來決定，這篇文章就不特別寫該如何安裝資料庫。</p><ul><li><a href=https://docs.sonarqube.org/latest/requirements/requirements/>SonarQube - Prerequisites and Overview</a></li></ul><h3 id=設定資料庫>設定資料庫</h3><p>在準備好資料庫後, 編輯 <code>$SONARQUBE-HOME/conf/sonar.properties</code> 這個設定檔來設定資料庫，這裡我使用 Oracle。設定參考如下，請再自己換成屬於自己環境的設定。</p><pre><code class=language-config data-lang=config># User credentials.
# Permissions to create tables, indices and triggers must be granted to JDBC user.
# The schema must be created first.
sonar.jdbc.username=username
sonar.jdbc.password=password
#----- Oracle 11g/12c/18c/19c
sonar.jdbc.url=jdbc:oracle:thin:@127.0.0.1:1521:sonarqubedb
</code></pre><h3 id=下載-jdbc-driver>下載 jdbc driver</h3><p>使用 Oracle 時還得要自己另外載下 jdbc driver, 並放到 <code>$SONARQUBE-HOME/extensions/jdbc-driver/oracle</code> 這個目錄底下，要特別注意的是千萬要下載 V12.1 以上的版本，像我一開始就是下載 v11.2.0.4.0 的版本，一直無法讓 Service 順利執行起來，還以為是不是連線字串有誤，查了老半天擔誤了不少時間後，才在 Log 裡看到一行錯誤訊息。</p><blockquote><p>Caused by: org.sonar.api.utils.MessageException: Unsupported Oracle driver version: 11.2.0.4.0. Minimal supported version is 12.1.</p></blockquote><p>這個錯誤就讓我多花了快兩個小時的時間&mldr;Orz</p><ul><li><a href=https://www.oracle.com/database/technologies/jdbc-upc-downloads.html>Oracle JDBC Driver download</a></li></ul><h3 id=將-sonarqube-以-windows-service-執行>將 SonarQube 以 Windows Service 執行</h3><p>SonarQube 已經準備好 Service 的執行檔，要安裝時執行</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-batch data-lang=batch>%SONARQUBE_HOME%/bin/windows-x86-64/InstallNTService.bat
</code></pre></div><p>解除安裝</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-batch data-lang=batch>%SONARQUBE_HOME%/bin/windows-x86-64/UninstallNTService.bat
</code></pre></div><p>要啟動或停止服務也只要執行以下的命令</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-batch data-lang=batch>%SONARQUBE_HOME%/bin/windows-x86-64/StartNTService.bat
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-batch data-lang=batch>%SONARQUBE_HOME%/bin/windows-x86-64/StopNTService.bat
</code></pre></div><p>Service 啟動後，打開瀏覽器輸入 <code>http://localhost:9000/</code>，看到 SonarQube 的畫面代表安裝已經完成。</p><p><img src=images/SonarQube_screen.PNG alt="SonarQube Screen"></p><ul><li><a href=https://docs.sonarqube.org/latest/setup/install-server/>SonarQube - Install the Server</a></li><li><a href=https://docs.sonarqube.org/latest/setup/operate-server/>SonarQube - Operating the Server</a></li></ul></div><footer><div class=stats></div></footer></article><article class=post><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//kodofish-github-io.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article><div class=pagination><a href=/post/2020-05-18_nuget_depredcating_package/ class="button left"><span>Nuget Deprecating Package</span></a>
<a href=/post/2020-04-23_redis_command_change_password/ class="button right"><span>用 CONFIG SET 來變更 redis 連線密碼</span></a></div></main><section id=site-sidebar><section id=recent-posts><header><h1>最新文章</h1></header><article class=mini-post><header><h2><a href=/post/2021-04-08_how_to_keep_and_running_web_application_on_iis/>如何設定 ASP.NET Core 網站應用程式持續執行在 IIS 上</a></h2><time class=published datetime="2021-04-08 00:00:00 +0800 +0800">April 8, 2021</time></header></article><article class=mini-post><a href=/post/2020-05-20_working_effectively_with_legacy_code_01/ class=image style="--bg-image:url('https://kodofish.dev/img/Working_Effectively_with_Legacy_Code_book.jpg')"><img src=https://kodofish.dev/img/Working_Effectively_with_Legacy_Code_book.jpg alt></a><header><h2><a href=/post/2020-05-20_working_effectively_with_legacy_code_01/>Working Effectively with Legacy Code - CH1 修改軟體</a></h2><time class=published datetime="2020-05-18 20:00:00 +0800 +0800">May 18, 2020</time></header></article><article class=mini-post><a href=/post/2020-05-18_nuget_depredcating_package/ class=image style="--bg-image:url('https://kodofish.dev/img/nuget-logo.png')"><img src=https://kodofish.dev/img/nuget-logo.png alt></a><header><h2><a href=/post/2020-05-18_nuget_depredcating_package/>Nuget Deprecating Package</a></h2><time class=published datetime="2020-05-18 19:19:13 +0800 +0800">May 18, 2020</time></header></article><article class=mini-post><a href=/post/2020-05-05_sonarqube_quick_install/ class=image style="--bg-image:url('https://kodofish.dev/img/fotis-fotopoulos-LJ9KY8pIH3E-unsplash.jpg')"><img src=https://kodofish.dev/img/fotis-fotopoulos-LJ9KY8pIH3E-unsplash.jpg alt></a><header><h2><a href=/post/2020-05-05_sonarqube_quick_install/>安裝 SonarQube - 為你的團隊建立軟體品質儀表板</a></h2><time class=published datetime="2020-05-05 13:24:55 +0800 +0800">May 5, 2020</time></header></article><article class=mini-post><a href=/post/2020-04-23_redis_command_change_password/ class=image style="--bg-image:url('https://kodofish.dev/img/redis_icon_text_l.png')"><img src=https://kodofish.dev/img/redis_icon_text_l.png alt></a><header><h2><a href=/post/2020-04-23_redis_command_change_password/>用 CONFIG SET 來變更 redis 連線密碼</a></h2><time class=published datetime="2020-04-23 16:49:54 +0800 +0800">April 23, 2020</time></header></article><footer><a href=/blog/ class=button>查看更多</a></footer></section><section id=categories><header><h1><a href=/categories>分類</a></h1></header><ul><li><a href=/categories/%E6%95%8F%E6%8D%B7%E4%BF%AE%E7%B7%B4%E5%A0%B4/>敏捷修練場<span class=count>7</span></a><li><a href=/categories/%E8%BB%9F%E9%AB%94%E9%96%8B%E7%99%BC/>軟體開發<span class=count>5</span></a><li><a href=/categories/asp.net-core/>asp.net-core<span class=count>1</span></a><li><a href=/categories/iis/>iis<span class=count>1</span></a><li><a href=/categories/redis/>redis<span class=count>1</span></a><li><a href=/categories/visual-studio-code/>visual-studio-code<span class=count>1</span></a></li></ul></section><section id=mini-bio><header><h1>關於</h1></header><p>關於 Kodofish, 但其實自介還沒寫</p><footer><a href=/about class=button>學到更多</a></footer></section></section><footer id=site-footer><ul class=socnet-icons><li><a href=//github.com/kodofish target=_blank rel=noopener title=GitHub class="fab fa-github"></a></li><li><a href=//www.linkedin.com/in/kodofishchang target=_blank rel=noopener title=LinkedIn class="fab fa-linkedin"></a></li><li><a href=//facebook.com/kodofish target=_blank rel=noopener title=Facebook class="fab fa-facebook"></a></li><li><a href=//instagram.com/kodofish target=_blank rel=noopener title=Instagram class="fab fa-instagram"></a></li><li><a href=//twitter.com/kodofish target=_blank rel=noopener title=Twitter class="fab fa-twitter"></a></li></ul><p class=copyright>© 2021 Kodofish Blog<br>主題: <a href=https://themes.gohugo.io/hugo-future-imperfect-slim/ target=_blank rel=noopener>Hugo Future Imperfect Slim</a><br>移植自 <a href=https://html5up.net/future-imperfect target=_blank rel=noopener>HTML5 UP</a> | 由 <a href=https://gohugo.io/ target=_blank rel=noopener title=0.82.0>Hugo</a> 提供</p></footer><a id=back-to-top href=# class="fas fa-arrow-up fa-2x"></a><script src=/js/bundle.min.ccb4e6bb4674f9a0e2b6ce56bb0cddea093526d4bc032314766519cdfec730b1.js integrity="sha256-zLTmu0Z0+aDits5Wuwzd6gk1JtS8AyMUdmUZzf7HMLE="></script><script src=/js/add-on.js></script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-132813063-1','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script></div></body></html>